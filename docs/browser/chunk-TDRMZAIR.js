import{ia as m}from"./chunk-JJWXYU2O.js";import{a as c,b as n,g as o,ga as l,j as u,ma as f,u as p,z as d}from"./chunk-GQVS24Z7.js";var g=(()=>{class i{constructor(){this.supabase=f(m).supabase}getHotels(){return p(this.supabase.from("hotels").select("*")).pipe(d(({data:r,error:e})=>{if(e)throw e;return r||[]}))}getHotelById(r){return p(this.supabase.from("hotels").select("*").eq("id",r).single()).pipe(d(({data:e,error:t})=>{if(t)throw t;return e}))}getFilteredHotels(r){return new u(e=>{this.getHotels().subscribe(t=>{e.next(this.applyFilters(t,r))})})}applyFilters(r,e){let t=[...r];if(e.minStars!==void 0&&(t=t.filter(s=>s.stars>=e.minStars)),e.maxStars!==void 0&&(t=t.filter(s=>s.stars<=e.maxStars)),e.minPrice!==void 0&&(t=t.filter(s=>s.price>=e.minPrice)),e.maxPrice!==void 0&&(t=t.filter(s=>s.price<=e.maxPrice)),e.sortBy)switch(e.sortBy){case"price-asc":t.sort((s,a)=>s.price-a.price);break;case"price-desc":t.sort((s,a)=>a.price-s.price);break;case"stars-asc":t.sort((s,a)=>s.stars-a.stars);break;case"stars-desc":t.sort((s,a)=>a.stars-s.stars);break}return t}addHotel(r){return o(this,null,function*(){let e=n(c({},r),{createdAt:new Date,updatedAt:new Date}),{data:t,error:s}=yield this.supabase.from("hotels").insert(e).select().single();if(s)throw s;return t.id})}updateHotel(r,e){return o(this,null,function*(){let{error:t}=yield this.supabase.from("hotels").update(n(c({},e),{updatedAt:new Date})).eq("id",r);if(t)throw t})}deleteHotel(r){return o(this,null,function*(){let{error:e}=yield this.supabase.from("hotels").delete().eq("id",r);if(e)throw e})}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=l({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{g as a};
